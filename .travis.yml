language: python
cache: pip
services:
  - postgresql
before_script:
  - psql -U postgres -c 'create extension postgis'
  - psql -U postgres -c 'create database bustimes'
  - ./manage.py migrate
script:
  - coverage run --source=buses,busstops,timetables manage.py test -v 3
  - pylint buses busstops timetables | cat
  - flake8 buses busstops timetables
after_script:
  - codeclimate-test-reporter
after_success:
  coveralls
virtualenv:
  system_site_packages: true
addons:
  apt:
    packages:
    - pylint
    - python-bs4
    - python-dateutil
    - python-lxml
    - python-psycopg2
    - python-requests
  code_climate:
    repo_token: 708f1fa88951cbab1881a4dd1ec450962596762244e871a62a59a537dc6eeefd
